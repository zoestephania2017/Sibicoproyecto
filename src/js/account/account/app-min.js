import{getUser,update}from"../../module/services/services-min.js";import{alert}from"../../module/alert-min.js";import{validateRequired,validatePhoneNumber,isEqual}from"../../module/validate-min.js";document.addEventListener("DOMContentLoaded",(async()=>{const e=document.querySelector("#frmAccount"),r=document.querySelector("#frmUpdatePassword");await async function(){let r=await getUser();e.querySelector("#txtUsername").value=r.usuario,e.querySelector("#txtName").value=r.nombre,e.querySelector("#txtSurname").value=r.apellido,e.querySelector("#txtAddress").value=r.direccion,e.querySelector("#txtPhone1").value=r.telefono_fijo,e.querySelector("#txtPhone2").value=r.telefono_movil}(),e.addEventListener("submit",(async r=>{if(r.preventDefault(),function(){if(!validateRequired(e.querySelector("#txtName").value))return alert("Campo requerido","El nombre es requerido.","warning","Ok",!0),!1;if(!validateRequired(e.querySelector("#txtSurname").value))return alert("Campo requerido","El apellido es requerido.","warning","Ok",!0),!1;validateRequired(e.querySelector("#txtAddress").value)||(e.querySelector("#txtAddress").value="N/A");return!0}()){let r={nombre:e.querySelector("#txtName").value,apellido:e.querySelector("#txtSurname").value,direccion:e.querySelector("#txtAddress").value,telefono_fijo:e.querySelector("#txtPhone1").value||"N/A",telefono_movil:e.querySelector("#txtPhone2").value||"N/A",type:"account"};const t=await update(r,"../../app/controllers/UserProfileController.php");if(t){let e=t?.success?"Transacción exitosa":"Error en la transacción",r=t?.success?"success":"warning";alert(e,t.message,r,"Ok",!0)}}})),r.addEventListener("submit",(async e=>{if(e.preventDefault(),function(){if(!validateRequired(r.querySelector("#txtCurrentPassword").value))return alert("Campo requerido","La contraseña actual es requerida.","warning","Ok",!0),!1;if(!validateRequired(r.querySelector("#txtNewPassword").value))return alert("Campo requerido","La nueva contraseña es requerida.","warning","Ok",!0),!1;if(!validateRequired(r.querySelector("#txtConfirmPassword").value))return alert("Campo requerido","La confirmación de contraseña es requerida.","warning","Ok",!0),!1;if(!isEqual(r.querySelector("#txtNewPassword").value,r.querySelector("#txtConfirmPassword").value))return alert("Campo requerido","La nueva contraseña y la confirmación de contraseña no coinciden.","warning","Ok",!0),!1;return!0}()){let e={clave_actual:r.querySelector("#txtCurrentPassword").value,clave_nueva:r.querySelector("#txtNewPassword").value,clave_confirmar:r.querySelector("#txtConfirmPassword").value,type:"change"};const t=await update(e,"../../app/controllers/UserProfileController.php");if(t){let e=t?.success?"Transacción exitosa":"Error en la transacción",r=t?.success?"success":"warning";alert(e,t.message,r,"Ok",!0)}}}))}));