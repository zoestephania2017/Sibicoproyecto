import options from"./option-min.js";import{validateVariable}from"../module/url-min.js";import{alert}from"../module/alert-min.js";import{read}from"../module/services/services-min.js";document.addEventListener("DOMContentLoaded",(async()=>{const e=validateVariable("denied"),t=validateVariable("_per"),a=await read("../app/controllers/ChartController.php?option=stockByStore"),r=await read("../app/controllers/ChartController.php?option=activeInactiveUsers"),o=await read("../app/controllers/ChartController.php?option=distributionOfSalesByTypeOfDocument"),i=await read("../app/controllers/ChartController.php?option=comparisonOfSalesBetweenStores"),n=document.querySelectorAll(".download-button");var s=document.getElementById("stockByStore").getContext("2d"),d=document.getElementById("activeInactiveUsers").getContext("2d"),l=document.getElementById("distributionOfSalesByTypeOfDocument").getContext("2d"),b=document.getElementById("comparisonOfSalesBetweenStores").getContext("2d"),g=["rgba(75, 192, 192, 0.7)","rgba(255, 99, 132, 0.7)","rgba(153, 102, 255, 0.7)","rgba(255, 159, 64, 0.7)","rgba(255, 205, 86, 0.7)","rgba(54, 162, 235, 0.7)","rgba(217, 179, 174, 0.7)","rgba(193, 225, 188, 0.7)","rgba(222, 184, 135, 0.7)","rgba(240, 128, 128, 0.7)","rgba(255, 182, 193, 0.7)","rgba(173, 216, 230, 0.7)","rgba(144, 238, 144, 0.7)","rgba(255, 228, 181, 0.7)","rgba(255, 218, 185, 0.7)","rgba(221, 160, 221, 0.7)","rgba(255, 240, 245, 0.7)","rgba(176, 224, 230, 0.7)","rgba(245, 222, 179, 0.7)"],c=["rgba(75, 192, 192, 1)","rgba(255, 99, 132, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)","rgba(255, 205, 86, 1)","rgba(54, 162, 235, 1)","rgba(217, 179, 174, 1)","rgba(193, 225, 188, 1)","rgba(222, 184, 135, 1)","rgba(240, 128, 128, 1)","rgba(255, 182, 193, 1)","rgba(173, 216, 230, 1)","rgba(144, 238, 144, 1)","rgba(255, 228, 181, 1)","rgba(255, 218, 185, 1)","rgba(221, 160, 221, 1)","rgba(255, 240, 245, 1)","rgba(176, 224, 230, 1)","rgba(245, 222, 179, 1)"],p=new Chart(s,{type:"bar",data:{labels:a.wineries,datasets:[{label:"Cantidad de productos por bodega",data:a.quantities,backgroundColor:g,borderColor:c,borderWidth:1}]},options:{scales:{y:{beginAtZero:!0}},devicePixelRatio:4}}),h=new Chart(d,{type:"doughnut",data:{labels:r.labels,datasets:[{label:"Cantidad de usuarios activos y inactivos",data:r.data,backgroundColor:g,borderColor:c,borderWidth:1}]},options:{scales:{y:{beginAtZero:!0}},devicePixelRatio:4}}),m=new Chart(l,{type:"pie",data:{labels:o.documents,datasets:[{label:"Cantidad de ventas por tipo de documento",data:o.quantity,backgroundColor:g,borderColor:c,borderWidth:1}]},options:{scales:{y:{beginAtZero:!0}},devicePixelRatio:4}}),u=new Chart(b,{type:"line",data:{labels:i.tienda,datasets:[{label:"Total de ventas por bodega",data:i.total,backgroundColor:g,borderColor:c,borderWidth:1,fill:!0,tension:.1}]},options:{scales:{y:{beginAtZero:!0}},devicePixelRatio:4}});!function(){if(e.exists&&!t.isEmpty)if(t.exists&&options.hasOwnProperty(t.value)){const{title:e,message:a}=options[t.value];alert(e,a,"warning","Ok",!0)}else alert("Error de permiso","El permiso proporcionado no es vÃ¡lido.","warning","Ok",!0)}(),n.forEach((e=>{e.addEventListener("click",(()=>{!function(e){let{chart:t,size:a}=function(e){let t={chart:null,size:{with:0,height:0}};switch(parseInt(e)){case 1:t.chart=p,t.size.with=1920,t.size.height=1080;break;case 2:t.chart=h,t.size.with=1200,t.size.height=1200;break;case 3:t.chart=m,t.size.with=1200,t.size.height=1200;break;case 4:t.chart=u,t.size.with=1920,t.size.height=1080;break}return t}(e),r=t.toBase64Image(),o=document.createElement("canvas");o.width=a.with,o.height=a.height;let i=o.getContext("2d"),n=new Image;n.src=r,n.onload=function(){i.drawImage(n,0,0,o.width,o.height);let e=document.createElement("a");e.href=o.toDataURL("image/png"),e.download="chart.png",e.click()}}(e.getAttribute("data-chart-index"))}))}))}));