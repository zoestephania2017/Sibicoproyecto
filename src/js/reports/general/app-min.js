import{validateRequired}from"../../module/validate-min.js";import{getDocument}from"../../module/services/services-min.js";document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".export-button"),t=document.querySelector("#btnSearch"),a=document.querySelector("#txtNumber"),l=document.querySelector("#txtDate"),n=document.querySelector("#txtExpiration"),r=document.querySelector("#txtStatus");let o=!1,s=new DataTable("#tblGeneral",{dom:"lBfrtip",async:!0,ajax:{url:"../../app/controllers/ReportController.php?isGet=true&get=generals&number=null&date=null&expiration=null&status=null",type:"GET",dataSrc:""},loading:!0,pageLength:25,columns:[{title:"C贸digo factura",data:"codigo_factura"},{title:"Numero",data:"numero"},{title:"Fecha de transacci贸n",data:"fecha_transaccion"},{title:"Fecha de vencimiento",data:"fecha_vencimiento"},{title:"Cliente",data:"cliente"},{title:"Responsable",data:"responsable"},{title:"Estado",data:"estado",render:function(e){switch(e){case"ACTIVO":return`\n                            <div class="flex flex-row gap-2 items-center justify-between">\n                                <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-green-100 text-green-800 border-green-400">${e}</span>\n                            </div>\n                        `;case"ANULADO":return`\n                            <div class="flex flex-row gap-2 items-center justify-between">\n                                <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-red-100 text-red-800 border-red-400">${e}</span>\n                            </div>\n                        `;case"DEVOLUCION":return`\n                            <div class="flex flex-row gap-2 items-center justify-between">\n                                <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-yellow-100 text-yellow-800 border-yellow-400">${e}</span>\n                            </div>\n                        `}}},{title:"Descuento",data:"descuento"},{title:"Impuesto",data:"impuesto"},{title:"Subtotal",data:"sub_total"},{title:"Total",data:"total"}],select:!1,responsive:!0,paging:!0,searching:!1,language:{url:"https://cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json"}});function d(){const e=document.getElementById("loading-indicator");e.style.display=o?"block":"none"}t.addEventListener("click",(()=>{let e=`../../app/controllers/ReportController.php?isGet=true&get=generals&number=${validateRequired(a.value)?a.value:"null"}&date=${validateRequired(l.value)?l.value:"null"}&expiration=${validateRequired(n.value)?n.value:"null"}&status=${validateRequired(r.value)?r.value:"null"}`;s&&s.destroy(),s=new DataTable("#tblGeneral",{dom:"lBfrtip",async:!0,ajax:{url:e,type:"GET",dataSrc:""},loading:!0,pageLength:25,columns:[{title:"C贸digo factura",data:"codigo_factura"},{title:"Numero",data:"numero"},{title:"Fecha de transacci贸n",data:"fecha_transaccion"},{title:"Fecha de vencimiento",data:"fecha_vencimiento"},{title:"Cliente",data:"cliente"},{title:"Responsable",data:"responsable"},{title:"Estado",data:"estado",render:function(e){switch(e){case"ACTIVO":return`\n                            <div class="flex flex-row gap-2 items-center justify-between">\n                                <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-green-100 text-green-800 border-green-400">${e}</span>\n                            </div>\n                        `;case"ANULADO":return`\n                            <div class="flex flex-row gap-2 items-center justify-between">\n                                <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-red-100 text-red-800 border-red-400">${e}</span>\n                            </div>\n                        `;case"DEVOLUCION":return`\n                            <div class="flex flex-row gap-2 items-center justify-between">\n                                <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-yellow-100 text-yellow-800 border-yellow-400">${e}</span>\n                            </div>\n                        `}}},{title:"Descuento",data:"descuento"},{title:"Impuesto",data:"impuesto"},{title:"Subtotal",data:"sub_total"},{title:"Total",data:"total"}],select:!1,responsive:!0,paging:!0,searching:!1,language:{url:"https://cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json"}})})),e.forEach((e=>{e.addEventListener("click",(async()=>{o=!0,d();let t=e.getAttribute("data-document-type"),s=`number=${validateRequired(a.value)?a.value:"null"}&date=${validateRequired(l.value)?l.value:"null"}&expiration=${validateRequired(n.value)?n.value:"null"}&status=${validateRequired(r.value)?r.value:"null"}`;switch(t){case"pdf":await getDocument(`../../app/controllers/ReportController.php?option=pdf&category=rpg&${s}`,"Reporte general","pdf"),o=!1,d();break;case"excel":await getDocument(`../../app/controllers/ReportController.php?option=xlsx&category=rpg&${s}`,"Reporte general","xlsx"),o=!1,d();break;case"csv":await getDocument(`../../app/controllers/ReportController.php?option=csv&category=rpg&${s}`,"Reporte general","csv"),o=!1,d();break;case"xml":await getDocument(`../../app/controllers/ReportController.php?option=xml&category=rpg&${s}`,"Reporte general","xml"),o=!1,d();break;default:o=!1,d()}}))}))}));