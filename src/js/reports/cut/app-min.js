import{validateRequired}from"../../module/validate-min.js";import{getDocument}from"../../module/services/services-min.js";document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".export-button"),t=document.querySelector("#btnSearch"),a=document.querySelector("#txtDate");let r=!1,n=new DataTable("#tblCuts",{dom:"lBfrtip",async:!0,ajax:{url:"../../app/controllers/ReportController.php?isGet=true&get=cuts",type:"GET",dataSrc:""},loading:!0,pageLength:25,columns:[{title:"C贸digo factura",data:"codigo_factura"},{title:"Numero",data:"numero"},{title:"Fecha de transacci贸n",data:"fecha_transaccion"},{title:"Cliente",data:"cliente"},{title:"Responsable",data:"responsable"},{title:"Estado",data:"estado",render:function(e){switch(e){case"ACTIVO":return`\n                            <div class="flex flex-row gap-2 items-center justify-between">\n                                <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-green-100 text-green-800 border-green-400">${e}</span>\n                            </div>\n                        `;case"ANULADO":return`\n                            <div class="flex flex-row gap-2 items-center justify-between">\n                                <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-red-100 text-red-800 border-red-400">${e}</span>\n                            </div>\n                        `;case"DEVOLUCION":return`\n                            <div class="flex flex-row gap-2 items-center justify-between">\n                                <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-yellow-100 text-yellow-800 border-yellow-400">${e}</span>\n                            </div>\n                        `}}},{title:"Descuento",data:"descuento"},{title:"Impuesto",data:"impuesto"},{title:"Subtotal",data:"sub_total"},{title:"Total",data:"total"}],select:!1,responsive:!0,paging:!0,searching:!1,language:{url:"https://cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json"}});function o(){const e=document.getElementById("loading-indicator");e.style.display=r?"block":"none"}t.addEventListener("click",(async()=>{let e="../../app/controllers/ReportController.php?isGet=true&get=cuts";validateRequired(a.value)&&(e=`../../app/controllers/ReportController.php?isGet=true&get=cuts&date=${a.value}`),n&&n.destroy(),n=new DataTable("#tblCuts",{dom:"lBfrtip",async:!0,ajax:{url:e,type:"GET",dataSrc:""},loading:!0,pageLength:25,columns:[{title:"C贸digo factura",data:"codigo_factura"},{title:"Numero",data:"numero"},{title:"Fecha de transacci贸n",data:"fecha_transaccion"},{title:"Cliente",data:"cliente"},{title:"Responsable",data:"responsable"},{title:"Estado",data:"estado",render:function(e){switch(e){case"ACTIVO":return`\n                                <div class="flex flex-row gap-2 items-center justify-between">\n                                    <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-green-100 text-green-800 border-green-400">${e}</span>\n                                </div>\n                            `;case"ANULADO":return`\n                                <div class="flex flex-row gap-2 items-center justify-between">\n                                    <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-red-100 text-red-800 border-red-400">${e}</span>\n                                </div>\n                            `;case"DEVOLUCION":return`\n                                <div class="flex flex-row gap-2 items-center justify-between">\n                                    <span class="text-xs w-full font-medium mr-2 px-2.5 py-0.5 rounded border bg-yellow-100 text-yellow-800 border-yellow-400">${e}</span>\n                                </div>\n                            `}}},{title:"Descuento",data:"descuento"},{title:"Impuesto",data:"impuesto"},{title:"Subtotal",data:"sub_total"},{title:"Total",data:"total"}],select:!1,responsive:!0,paging:!0,searching:!1,language:{url:"https://cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json"}})})),e.forEach((e=>{e.addEventListener("click",(async()=>{switch(r=!0,o(),e.getAttribute("data-document-type")){case"pdf":await getDocument(`../../app/controllers/ReportController.php?option=pdf&category=rpc&date=${a.value}`,"Reporte de corte diario","pdf"),r=!1,o();break;case"excel":await getDocument(`../../app/controllers/ReportController.php?option=xlsx&category=rpc&date=${a.value}`,"Reporte de corte diario","xlsx"),r=!1,o();break;case"csv":await getDocument(`../../app/controllers/ReportController.php?option=csv&category=rpc&date=${a.value}`,"Reporte de corte diario","csv"),r=!1,o();break;case"xml":await getDocument(`../../app/controllers/ReportController.php?option=xml&category=rpc&date=${a.value}`,"Reporte de corte diario","xml"),r=!1,o();break;default:r=!1,o()}}))}))}));